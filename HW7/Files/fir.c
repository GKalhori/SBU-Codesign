#include "stdio.h"
#define conv_param 16777216	// 2^24

volatile int *in_ready	= (volatile int *) 0x80000000;
volatile int *out_ready = (volatile int *) 0x80000004;
volatile int *in_coef	= (volatile int *) 0x80000008;
volatile int *out_res	= (volatile int *) 0x90000008;
volatile int *out_sign	= (volatile int *) 0xA0000008;


// 32 bit: s(1), m(7), n(24)
int to_fixed(double float_num) {
    return (int)(float_num * conv_param);
}

double to_float(int int_num) {
    return 1.0 * int_num / conv_param;
}

int main() {
    double coeff[67] = {0.000546024755771983, -8.00488171187003e-19, -0.000641650065867609, -0.00104725705356440,
                        -0.000877258147492076, 1.27886017174141e-18, 0.00127652786106233, 0.00218580141828661,
                        0.00186568941030091, -2.32847245018841e-18, -0.00267514624146246, -0.00448838701221188,
                        -0.00374221969880826, 3.79895321245428e-18, 0.00511581347459534, 0.00839744539407861,
                        0.00686453751885322, -5.47963530561660e-18, -0.00909146654707184, -0.0147536388082741,
                        -0.0119626104967189, 7.12973726512319e-18, 0.0157664648229160, 0.0256998900276194,
                        0.0210528838383762, -8.51285866278668e-18, -0.0290097940801829, -0.0492117508516849,
                        -0.0427435305950880, 9.43084780939840e-18, 0.0736794505899312, 0.157941404747747,
                        0.224766065816018, 0.250173419845741, 0.224766065816018, 0.157941404747747,
                        0.0736794505899312, 9.43084780939840e-18, -0.0427435305950880, -0.0492117508516849,
                        -0.0290097940801829, -8.51285866278668e-18, 0.0210528838383762, 0.0256998900276194,
                        0.0157664648229160, 7.12973726512319e-18, -0.0119626104967189, -0.0147536388082741,
                        -0.00909146654707184, -5.47963530561660e-18, 0.00686453751885322, 0.00839744539407861,
                        0.00511581347459534, 3.79895321245428e-18, -0.00374221969880826, -0.00448838701221188,
                        -0.00267514624146246, -2.32847245018841e-18, 0.00186568941030091, 0.00218580141828661,
                        0.00127652786106233, 1.27886017174141e-18, -0.000877258147492076, -0.00104725705356440,
                        -0.000641650065867609, -8.00488171187003e-19, 0.000546024755771983};
    
	*in_ready = 0;	// disable hardware start signal
    
	int i;
    for (i = 0; i < 67; i++) {
        in_coef[i] = to_fixed(coeff[i]);
    }

    *in_ready = 1;	// enable hardware start signal

    while (!(*out_ready));	// wait till the result is ready

	int j;
    for (j = 0; j < 120; j++) {
        double out = to_float(out_res[j]);
        out = (out_sign[j]) ? -out : out;
        printf("%d)	%lf\n", j, out);
    }
    return 0;
}
